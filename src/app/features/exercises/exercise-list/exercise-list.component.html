<main class="...">
    
    <header class="md:hidden bg-brand-surface border-b border-brand-surface-light p-4 flex items-center justify-between z-10">
      <div class="flex items-center gap-4">
        <a *ngIf="isSelectionMode" routerLink="/tracker" class="text-brand-text-muted">
           <span class="text-xs">Cancelar</span>
        </a>
        <a *ngIf="!isSelectionMode" routerLink="/profile" class="text-brand-text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" /></svg>
        </a>
        
        <h1 class="font-bold text-xl text-white">{{ isSelectionMode ? 'Añadir a Rutina' : 'Ejercicios' }}</h1>
      </div>
      
      <button *ngIf="!isSelectionMode" (click)="createCustomExercise()" class="text-brand-primary font-bold text-sm px-2 py-1 active:opacity-70 transition-opacity">
        Crear
      </button>
    </header>

    <div class="flex-1 ...">

      <div class="hidden md:flex justify-between items-center mb-6">
        <div>
          <h2 class="text-3xl font-bold text-white">{{ isSelectionMode ? 'Seleccionar Ejercicio' : 'Biblioteca' }}</h2>
          <p class="text-brand-text-muted text-sm">
            {{ isSelectionMode ? 'Haz clic para añadir a tu entrenamiento.' : 'Explora o crea nuevos ejercicios.' }}
          </p>
        </div>
        <button *ngIf="isSelectionMode" routerLink="/tracker" class="bg-brand-surface border border-brand-surface-light text-white px-4 py-2 rounded-xl font-bold text-sm hover:bg-brand-surface-light transition-all">
          Cancelar Selección
        </button>
        <button *ngIf="!isSelectionMode" (click)="createCustomExercise()" class="...">
          <span>+</span> Crear Ejercicio
        </button>
      </div>

      <div class="space-y-2">
        <div *ngFor="let ex of filteredExercises" 
             (click)="onExerciseSelect(ex)" 
             class="bg-brand-surface p-4 rounded-xl border border-brand-surface-light flex justify-between items-center hover:border-brand-primary/50 transition-colors cursor-pointer group relative">
          
          <div class="flex items-center gap-4">
            <div class="w-10 h-10 rounded-lg bg-brand-surface-light flex items-center justify-center text-brand-text-muted font-bold group-hover:text-white transition-colors">
              {{ ex.name.charAt(0) }}
            </div>
            <div>
              <h3 class="font-bold text-white text-sm md:text-base" [class.text-brand-primary]="isSelectionMode">{{ ex.name }}</h3>
              <p class="text-xs text-brand-text-muted">{{ ex.muscle }} • {{ ex.equipment }}</p>
            </div>
          </div>
          
          <div *ngIf="isSelectionMode" class="text-brand-primary">
             <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
          </div>

          <a *ngIf="!isSelectionMode" [routerLink]="['/exercises', ex.id]" class="text-brand-primary transition-opacity opacity-100 md:opacity-0 md:group-hover:opacity-100 p-1 cursor-pointer z-10" (click)="$event.stopPropagation()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" class="w-7 h-7">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
            </svg>
          </a>

        </div>
        </div>